#!/bin/bash
Component=${PWD##*/}

case "$Component" in
    *leave* |*suspend*|*hibernate*|*shutdown*|*logout*|*reboot*|lockscreen*) 
    echo "leave stuff, doing later...";;
   
	
	*archiver*)
    echo "archiver"
    for file in translations/desktop_*.ts
			do
		
			language=$(cat $file | grep -o -P '(?<=language=\").*(?=\"\>)')
			echo "# Do not edit, file generated by lxqt-ts2desktop. Please edit only desktop_*.ts files in LXQt-Weblate or Qt-Linguist" >  /tmp/$Component"_"$language.desktop
  		cat $file |grep -oP '(?<=translation>)[^<]+' | sed -n 1p | sed 's/^/Name['$language']=/' >> /tmp/$Component"_"$language.desktop
			cat $file |grep -oP '(?<=translation>)[^<]+' | sed -n 2p | sed 's/^/GenericName['$language']=/' >>  /tmp/$Component"_"$language.desktop
			cat $file |grep -oP '(?<=translation>)[^<]+' | sed -n 3p | sed 's/^/Comment['$language']=/' >>  /tmp/translations/$Component"_"$language.desktop
	done ;;
    
	* ) echo "altri file"
	 for file in translations/desktop_*.ts
			do
		
			language=$(cat $file | grep -o -P '(?<=language=\").*(?=\"\>)')
			echo "# Do not edit, file generated by lxqt-ts2desktop. Please edit only desktop_*.ts files in LXQt-Weblate or Qt-Linguist" >  translations/$Component"_"$language.desktop
  		cat $file |grep -oP '(?<=translation>)[^<]+' | sed -n 1p | sed 's/^/Name['$language']=/' >> translations/$Component"_"$language.desktop
			cat $file |grep -oP '(?<=translation>)[^<]+' | sed -n 2p | sed 's/^/GenericName['$language']=/' >>  translations/$Component"_"$language.desktop
			cat $file |grep -oP '(?<=translation>)[^<]+' | sed -n 3p | sed 's/^/Comment['$language']=/' >>  translations/$Component"_"$language.desktop
	done ;;
esac
